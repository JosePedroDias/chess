import m from '../../../vendor/mithril.mjs';

import { CW, STROKE_WIDTH, SHOW_KEYS } from '../constants.mjs';
import { BLACK, WHITE, BLACK_S, WHITE_S } from '../colors.mjs';

export function Knight({ isWhite, id }, { pos }) {
    const fill = isWhite ? WHITE : BLACK;
    const stroke = isWhite ? WHITE_S : BLACK_S;

    const x = pos[0] * CW;
    const y = pos[1] * CW;

    return m('g.enter',
        {
            key: id,
            transform: `translate(${x}, ${y})`,
            style: `fill:${fill}; stroke:${stroke}; stroke-width:${STROKE_WIDTH}; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4`,
            onbeforeremove(vnode) {
                vnode.dom.classList.add('leave');
                return new Promise((resolve) => vnode.dom.addEventListener('animationend', resolve));
            }
        },
        [
            m('title', `${isWhite ? 'white' : 'black'} knight`),
            SHOW_KEYS && m(
                'text',
                {
                    x: 0,
                    y: 0,
                    dy: CW,
                    style: `stroke:none; fill:${fill}; font-size:7px; font-weight:600`,
                },
                id,
            ),
            m('path', {
                d: `m 19.489987,6.7787509 c -0.43858,0.0741 -0.80514,0.40433 -0.98975,0.80114 -0.1914,0.39554 -0.21602,0.84187 -0.31398,1.26442 -0.0596,0.37607 -0.17512,0.74615 -0.3806,1.06919 -0.40411,0.6580501 -1.0176,1.1439401 -1.59373,1.6428401 -0.65876,0.60112 -1.04479,1.43142 -1.3276,2.26224 -0.22879,0.67863 -0.41634,1.37294 -0.7111,2.0276 -0.12949,0.29909 -0.27441,0.59133 -0.43062,0.87734 -0.0311,0.0552 -0.0835,0.15063 -0.12505,0.22138 -0.10919,0.18827 -0.2393,0.39566 -0.35021,0.56273 -0.46774,0.68255 -0.96341,1.34548 -1.43996,2.02187 -0.45768,0.64655 -0.92162,1.28908 -1.36913,1.94262 -0.43261,0.70276 -0.44723,1.67542 0.0591,2.34539 0.25476,0.32742 0.61262,0.55568 0.96998,0.75659 0.5375,0.27902 1.11539,0.47329 1.69754,0.63563 0.45419,0.1193 0.91551,0.2219 1.38283,0.27006 0.33086,0.0215 0.63192,-0.17999 0.8179,-0.44103 0.41777,-0.55945 0.72434,-1.21328 1.25816,-1.67822 0.35693,-0.31319 0.82746,-0.4698 1.29721,-0.494 0.44783,-0.0437 0.90897,-0.0374 1.33691,-0.19431 0.72204,-0.23078 1.36521,-0.65303 1.94119,-1.13822 0.61817,-0.50267 1.16898,-1.08096 1.6901,-1.68206 0.0935,-0.10017 0.18686,-0.22677 0.27898,-0.31047 0.34737,0.51084 0.6384,1.0867 0.67952,1.71319 0.0117,0.19292 0.0371,0.39022 0.01,0.58177 -0.16353,0.73427 -0.55147,1.40419 -1.05858,1.95479 -0.40809,0.46923 -0.87794,0.87885 -1.36583,1.26254 -1.29709,1.0567 -2.58869,2.15989 -3.56089,3.53498 -0.5176,0.7337 -0.93898,1.54323 -1.18719,2.40817 -0.0361,0.17826 0.11208,0.36016 0.29506,0.35529 0.52791,-0.0613 1.05535,-0.13568 1.58488,-0.18654 0.84237,-0.0877 1.70803,-0.15137 2.55529,-0.19208 0.9708,-0.0467 1.94618,-0.0587 2.92245,-0.0624 0.95873,0.0259 1.91689,0.0729 2.87329,0.14488 0.53097,0.0414 1.08578,0.0916 1.62473,0.14947 0.47593,0.0501 0.94819,0.12876 1.41875,0.21433 0.18318,0.0174 0.33394,-0.13674 0.3593,-0.31035 0.45165,-1.54289 0.87188,-3.09559 1.23379,-4.66207 0.23254,-1.05139 0.38378,-2.12604 0.35981,-3.20496 -0.007,-0.8193 0.002,-1.64989 0.0196,-2.45883 -9.4e-4,-1.29754 -0.19613,-2.57995 -0.51682,-3.83116 -0.45654,-1.79462 -1.50105,-3.42966 -2.92559,-4.61089 -0.95172,-0.80701 -2.04499,-1.43751 -3.20006,-1.90493 -0.31329,-0.13873 -0.63215,-0.27106 -0.97079,-0.33373 -0.28428,-0.0694 -0.55575,-0.1841101 -0.81003,-0.3280801 -0.32129,-0.039 -0.64253,-0.0783 -0.9638,-0.11745 -0.93564,-0.92977 -1.8674,-1.86372 -2.80546,-2.79088 -0.0745,-0.0618 -0.17266,-0.094 -0.26927,-0.0878 z m 0.30989,6.5601401 c 0.45025,0.035 0.85972,0.43321 0.85729,0.89323 -0.0197,0.32848 -0.32333,0.54545 -0.60681,0.65113 -0.26795,0.10523 -0.56343,0.1195 -0.84415,0.0632 -0.34275,-0.0444 -0.70091,-0.0248 -1.02273,0.10957 0.16409,-0.54105 0.40071,-1.09643 0.85052,-1.46171 0.21569,-0.16939 0.48714,-0.28523 0.76588,-0.25547 z`,
                stroke: `none`,
            }),
            m('path', {
                d: `m 21.618107,31.258901 c -2.0033,0.0172 -4.00656,0.10851 -6.00164,0.29125 -0.8893,0.0978 -1.77941,0.26128 -2.61687,0.58347 -0.68017,0.2703 -1.27751,0.77077 -1.60777,1.42993 -0.28436,0.54095 -0.38021,1.15489 -0.41761,1.75823 -0.0493,0.65209 -0.0635,1.30886 -0.0276,1.96128 0.0178,0.0804 0.0465,0.15368 0.11735,0.20134 0.0956,0.10483 0.25461,0.0827 0.38395,0.0852 7.11878,-5.3e-4 14.23764,0.001 21.35636,-8e-4 0.19464,10e-4 0.34699,-0.1852 0.3286,-0.37487 0.0297,-0.8534 0.002,-1.71062 -0.10856,-2.55772 -0.10911,-0.73168 -0.44502,-1.44439 -1.01285,-1.9305 -0.46931,-0.41738 -1.06554,-0.6513 -1.66339,-0.8164 -0.69547,-0.20233 -1.42024,-0.26401 -2.13598,-0.35461 -1.66267,-0.18403 -3.33624,-0.24158 -5.00788,-0.27018 -0.52866,-0.008 -1.05741,-0.008 -1.58611,-0.006 z`,
                stroke: `none`,
            }),
            m('path', {
                d: `m 21.617587,30.992231 c -2.04024,0.0206 -4.08093,0.1086 -6.11223,0.30252 -0.93987,0.10917 -1.88295,0.28698 -2.75814,0.65681 -0.73449,0.32926 -1.35615,0.92178 -1.67674,1.66463 -0.33204,0.734 -0.36172,1.55293 -0.39916,2.34449 -0.0164,0.45858 -0.0175,0.91918 0.0136,1.37668 0.0469,0.2819 0.31239,0.50347 0.59829,0.49808 7.17817,0.002 14.3564,5.4e-4 21.53458,-2.6e-4 0.3352,-6.7e-4 0.61206,-0.32656 0.58237,-0.65578 0.0272,-0.90954 9.4e-4,-1.82414 -0.13602,-2.72468 -0.14746,-0.79865 -0.56034,-1.56085 -1.20967,-2.06027 -0.60884,-0.4786 -1.36576,-0.71211 -2.11077,-0.88 -0.67468,-0.13692 -1.361,-0.20376 -2.04437,-0.28078 -1.76204,-0.1753 -3.53388,-0.22409 -5.3037,-0.24178 -0.32602,-0.002 -0.65205,4e-4 -0.97807,4e-4 z`,
                fill: `none`,
            }),
            m('path', {
                d: `m 19.630607,13.607641 c -0.40041,0.0648 -0.68407,0.40395 -0.8715,0.73983 -0.0583,0.10538 -0.11512,0.21879 -0.15766,0.32788 0.299,-0.0392 0.59966,6.6e-4 0.89635,0.0365 0.31732,0.004 0.66801,-0.10316 0.85859,-0.37109 0.0976,-0.21352 -0.0486,-0.45172 -0.21288,-0.58577 -0.1422,-0.11406 -0.33125,-0.17275 -0.5129,-0.1473 z`,
                fill: `none`,
            }),
            m('path', {
                d: `m 19.522277,6.5115609 c -0.42719,0.0324 -0.812,0.29555 -1.06771,0.63021 -0.3103,0.40156 -0.39668,0.91431 -0.47953,1.40124 -0.0751,0.39622 -0.14194,0.80543 -0.35197,1.15722 -0.40449,0.6976101 -1.06025,1.1883601 -1.6519,1.7159901 -0.70191,0.67257 -1.1048,1.58511 -1.39872,2.49605 -0.14512,0.44532 -0.28767,0.91656 -0.44521,1.34172 -0.34038,0.90213 -0.80937,1.75364 -1.37847,2.53151 -0.84257,1.17871 -1.69572,2.3546 -2.51892,3.54972 -0.48776,0.78979 -0.49609,1.88155 0.0691,2.63518 0.32619,0.41898 0.79009,0.70463 1.26005,0.93686 0.81206,0.37706 1.68051,0.62621 2.56115,0.78078 0.28943,0.0457 0.59708,0.108 0.87757,-0.0127 0.31774,-0.11673 0.55007,-0.37866 0.72959,-0.65579 0.37594,-0.53576 0.67722,-1.14913 1.2103,-1.55203 0.33091,-0.24064 0.7434,-0.32919 1.1456,-0.3456 0.46609,-0.0333 0.94254,-0.0566 1.38197,-0.23163 0.92255,-0.31773 1.70462,-0.92938 2.4172,-1.57958 0.45124,-0.41573 0.86706,-0.86788 1.26954,-1.33042 0.26267,0.43383 0.44928,0.9245 0.45989,1.43645 0.0215,0.19841 0.0157,0.40063 -0.0545,0.58957 -0.19161,0.65916 -0.58236,1.24314 -1.05334,1.73595 -0.58193,0.64424 -1.29508,1.14628 -1.95106,1.70911 -1.23239,1.03881 -2.41903,2.17437 -3.25832,3.56379 -0.36489,0.6083 -0.40011,0.72601 -0.58724,1.41119 -0.0678,0.34044 0.2434,0.78022 0.59088,0.74486 0.84666,-0.10559 1.3811,-0.1068 2.22645,-0.17291 1.37427,-0.11416 2.7894,-0.079 4.16973,-0.0847 0.64404,-0.008 1.28144,0.0303 1.92653,0.0595 0.52114,0.0275 1.04384,0.0606 1.55895,0.10374 0.80469,0.0693 1.60193,0.13487 2.40009,0.27631 0.21845,0.0293 0.45303,0.12407 0.66458,0.0151 0.20953,-0.0921 0.33323,-0.30678 0.37166,-0.52497 0.46518,-1.6035 0.90578,-2.94859 1.26789,-4.57879 0.22717,-1.07691 0.37833,-1.71843 0.42481,-3.2677 -0.11834,-3.62571 -0.39609,-5.55791 -0.83446,-6.83575 -0.56568,-1.63061 -1.60969,-3.08705 -2.95931,-4.16109 -0.96013,-0.78315 -2.05447,-1.3902 -3.20188,-1.85196 -0.32059,-0.14622 -0.65672,-0.2557301 -1.00134,-0.3281701 -0.25138,-0.0668 -0.48498,-0.18754 -0.71367,-0.30516 -0.30343,-0.0366 -0.60679,-0.0738 -0.91019,-0.11068 -0.92301,-0.91641 -1.83976,-1.8395 -2.76796,-2.75025 -0.11205,-0.0894 -0.25446,-0.14088 -0.39792,-0.14219 z`,
                fill: `none`,
            }),
        ]
    );
}
