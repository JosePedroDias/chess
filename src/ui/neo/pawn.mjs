import m from '../../../vendor/mithril.mjs';

import { CW, STROKE_WIDTH, SHOW_KEYS } from '../constants.mjs';
import { BLACK, WHITE, BLACK_S, WHITE_S } from '../colors.mjs';

export function Pawn({ isWhite, id }, { pos }) {
    const fill = isWhite ? WHITE : BLACK;
    const stroke = isWhite ? WHITE_S : BLACK_S;

    const x = pos[0] * CW;
    const y = pos[1] * CW;

    return m('g.enter',
        {
            key: id,
            transform: `translate(${x}, ${y})`,
            style: `fill:${fill}; stroke:${stroke}; stroke-width:${STROKE_WIDTH}; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4`,
            onbeforeremove(vnode) {
                vnode.dom.classList.add('leave');
                return new Promise((resolve) => vnode.dom.addEventListener('animationend', resolve));
            }
        },
        [
            m('title', `${isWhite ? 'white' : 'black'} pawn`),
            SHOW_KEYS && m(
                'text',
                {
                    x: 0,
                    y: 0,
                    dy: CW,
                    style: `stroke:none; fill:${fill}; font-size:7px; font-weight:600`,
                },
                id,
            ),
            m('path', {
                d: `m 21.998626,11.636129 c -1.50562,0.0429 -2.97725,0.78196 -3.89957,1.97485 -1.01177,1.28657 -1.37114,3.06714 -0.90289,4.63955 0.28873,0.99312 0.88711,1.88924 1.67753,2.55386 -0.85192,0.56434 -1.70751,1.12315 -2.5554,1.69292 -0.22615,0.17848 -0.26753,0.49308 -0.22024,0.7606 0.0592,0.53786 0.26637,1.06516 0.60954,1.48488 0.18483,0.19678 0.47303,0.19638 0.72301,0.19134 0.6036,0.009 1.2072,0.0188 1.81079,0.0282 -0.0906,0.98191 -0.34458,1.95023 -0.77123,2.84027 -0.58733,1.24001 -1.49513,2.31967 -2.5963,3.13548 -0.50063,0.38281 -1.0323,0.72286 -1.53783,1.09868 -1.00795,0.79106 -1.68283,1.94668 -2.02934,3.16891 -0.22546,0.7893 -0.33313,1.61553 -0.29975,2.43577 0.0443,0.31554 0.37382,0.53398 0.68238,0.49113 6.37063,-10e-4 12.74138,5.3e-4 19.11194,-0.003 0.33165,-0.01 0.59201,-0.34258 0.55184,-0.66622 0.0169,-1.41317 -0.35965,-2.83385 -1.09596,-4.04175 -0.30461,-0.48941 -0.69632,-0.92113 -1.14056,-1.28724 -0.38192,-0.36308 -0.86411,-0.59098 -1.28073,-0.90873 -1.26337,-0.90833 -2.34191,-2.10453 -2.99879,-3.52339 -0.0349,-0.0763 -0.092,-0.20527 -0.12357,-0.28251 -0.29845,-0.70925 -0.47236,-1.46454 -0.56374,-2.22703 -0.0121,-0.0876 -0.0241,-0.17517 -0.034,-0.26305 0.72612,-0.002 1.45286,0.009 2.17859,-0.006 0.27988,-0.0317 0.46286,-0.27779 0.58104,-0.51137 0.24312,-0.44131 0.40579,-0.93831 0.41349,-1.44462 -0.02,-0.28053 -0.23396,-0.50048 -0.472,-0.62521 -0.7794,-0.50948 -1.55882,-1.0187 -2.33759,-1.52911 0.8154,-0.6721 1.44621,-1.58661 1.70395,-2.61772 0.28027,-1.07467 0.27561,-2.24904 -0.15303,-3.28481 -0.3482,-0.87796 -0.9762,-1.61902 -1.70404,-2.20925 -0.9252,-0.75764 -2.14261,-1.10001 -3.32752,-1.06534 z`,
                stroke: `none`,
            }),
            m('path', {
                d: `m 22.002526,11.902789 c -1.30059,0.0399 -2.57531,0.62138 -3.45039,1.58571 -1.0733,1.16294 -1.53039,2.86279 -1.1728,4.40587 0.26324,1.1718 0.98038,2.22514 1.95034,2.92825 -0.94537,0.626 -1.8935,1.24805 -2.83717,1.87651 -0.13957,0.10952 -0.16127,0.29846 -0.13593,0.46278 0.0393,0.49584 0.22529,0.98106 0.52499,1.37693 0.13016,0.15242 0.34397,0.12412 0.52303,0.1283 0.71105,0.0111 1.4221,0.0222 2.13315,0.0332 -0.054,0.51825 -0.10869,1.03808 -0.23704,1.54434 -0.36493,1.54563 -1.17977,2.97843 -2.31369,4.08944 -0.6551,0.65497 -1.43224,1.16644 -2.18742,1.69605 -0.93677,0.62178 -1.61825,1.57395 -2.0226,2.61387 -0.36381,0.93529 -0.53506,1.94529 -0.50808,2.94791 0.0243,0.18021 0.20757,0.29834 0.38275,0.27395 6.37347,-8e-4 12.74697,-1.4e-4 19.12041,-0.002 0.18944,6.7e-4 0.33542,-0.18323 0.31425,-0.36707 0.0238,-1.27859 -0.29289,-2.56292 -0.90746,-3.6842 -0.30411,-0.55049 -0.70995,-1.04488 -1.19894,-1.44112 -0.23324,-0.23045 -0.50864,-0.40919 -0.78732,-0.57884 -0.33503,-0.21595 -0.65857,-0.44954 -0.96992,-0.69839 -0.0406,-0.0344 -0.12353,-0.10183 -0.18035,-0.14888 -1.21074,-1.01346 -2.20004,-2.31953 -2.72563,-3.81672 -0.0711,-0.19844 -0.13302,-0.40013 -0.18821,-0.60356 -0.0235,-0.0883 -0.0554,-0.21542 -0.0782,-0.32022 -0.0552,-0.24332 -0.0912,-0.4704 -0.12993,-0.7204 -0.0396,-0.27342 -0.0749,-0.54751 -0.10301,-0.82235 0.80545,-10e-4 1.61143,0.006 2.41657,-8e-4 0.18592,-0.008 0.29602,-0.17522 0.37662,-0.32288 0.23496,-0.40284 0.38766,-0.86015 0.41415,-1.32657 -0.006,-0.18649 -0.14512,-0.33169 -0.30266,-0.41332 -0.89963,-0.58897 -1.80496,-1.17777 -2.70104,-1.76685 0.80179,-0.58077 1.46046,-1.38154 1.78856,-2.32248 0.24487,-0.71151 0.34338,-1.47566 0.28085,-2.22582 -0.0769,-0.92986 -0.46749,-1.82144 -1.06864,-2.5316 -0.37873,-0.44455 -0.81379,-0.84675 -1.30728,-1.16104 -0.80662,-0.49538 -1.76997,-0.71708 -2.71191,-0.68827 z`,
                fill: `none`,
            }),
        ]
    );
}
